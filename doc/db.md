# Модель базы данных

Проект работает со следующими базами данных:

- `default` - хранит основную информацию приложения
- `stat` - для сбора статистики
- `service` - служебные данные, например для создания антиспам-защиты

Этот способ выбраны для того, чтобы приложение можно было легко масштабировать: при необходимости выносить данные на отдельный сервер.

## `default`

Содержит следующие таблицы:

- `todos` - список задач

Структура таблицы `todos`:

| Поле | Тип | Extra |
|------|-----|-------|
| `id` | `int` | `PK`, `auto_increment` |
| `text` | `varchar(255)` | `not null` |
| `completed` | `tinyint` | `not null` |

Индексы:

| Название | Поля | Extra |
|----------|------|-------|
| `GET_completed` | `completed` | `asc` |

## `stat`

Содержит следующие таблицы:

- `metric` - метрики проекта

Структура таблицы `metric`:

| Поле | Тип | Extra |
|------|-----|-------|
| `key` | `varchar(255)` | `PK` |
| `value` | `int` | `not null` |
| `extra` | `json` | `not null` |

## `service`

Содержит следующие таблицы:

- `antispam_ip` - для ограничения числа вызовов по IP адресу

Структура таблицы `antispam_ip`:

| Поле | Тип | Extra |
|------|-----|-------|
| `ipv4` | `varchar(15)` | `PK` |
| `key` | `varchar(255)` | `PK` |
| `expire` | `int` | `not null` |
| `count` | `int` | `not null` |
| `is_stat_sent` | `tinyint` | `not null` |
| `extra` | `json` | `not null` |

## Дополнительно

Поле `extra` в проекте не используется. Это просто следование практике добавлять его всюду. Его используют для помещения в него дополнительных колонок; такая необходимость возникает, когда нужно изменить структуру таблицы на работающем сервере, что при использовании `alter` приводит к большим затратам времени и дополнительным затратам ресурсов диска. Подробнее: [1], [2]

[1]: https://stackoverflow.com/q/12774709 
[2]: https://habr.com/ru/company/oleg-bunin/blog/443422
